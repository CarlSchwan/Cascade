name: Windows Build

on:
  [push , pull_request, workflow_dispatch]

jobs:
  build-windows:

    runs-on: windows-2019

    steps:
    - uses: actions/checkout@v3
    - uses: ilammy/msvc-dev-cmd@v1
    
    - name: Install Qt
      uses: jurplel/install-qt-action@v2
      with:
        arch: win64_msvc2019_64
        setup-python: false
      
    - name: Install Vulkan SDK
      uses: humbletim/setup-vulkan-sdk@v1.2.0
      with:
        vulkan-query-version: 1.2.198.1
        vulkan-components: Vulkan-Headers, Vulkan-Loader
        vulkan-use-cache: true
        
    - name: Install vcpkg packages
      run: |
        git clone https://github.com/microsoft/vcpkg
        .\vcpkg\bootstrap-vcpkg.bat
        .\vcpkg\vcpkg --feature-flags="versions" --triplet=x64-windows  install
        
    - name: Build
      run: |
        qmake
        make -j4
